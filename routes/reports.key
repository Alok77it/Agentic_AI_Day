from fastapi import APIRouter, UploadFile, Form
from services.firebase import store_incident
from services.gemini import analyze_text_image

router = APIRouter()

@router.post("/")
async def submit_report(
    description: str = Form(...),
    location: str = Form(...),
    image: UploadFile = None
):
    result = await analyze_text_image(description, image)
    response = await store_incident(result)
    return {"status": "stored", "id": response}

